
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>Tafels oefenen</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="style.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="site-wrapper">

      <div class="site-wrapper-inner">

        <div class="cover-container">

          <div class="masthead clearfix">
            <div class="inner">
              <h3 class="masthead-brand">Tafels oefenen</h3>
              <ul class="nav masthead-nav">
                <li class="active"><a href="#"><span class="glyphicon glyphicon-random"></span></a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">4</a></li>
                <li><a href="#">5</a></li>
                <li><a href="#">6</a></li>
                <li><a href="#">7</a></li>
                <li><a href="#">8</a></li>
                <li><a href="#">9</a></li>
                <li><a href="#">10</a></li>
              </ul>
            </div>
          </div>

          <div class="inner cover">
            <!-- #loading -->
            <div id="loading">
              <p>Bezig met laden...</p>
            </div>
            <!-- /#loading -->
            <!-- #intro -->
            <div id="intro"><p class="lead">Hoi! Tafels oefenen is niet altijd zo leuk, maar je leert er wel snel mee rekenen. Daarom krijg je na elke vijf juiste oplossingen hier een grappig filmpje te zien. Je kiest zelf welke tafels je wil oefenen, bovenaan de pagina. Opgelet! Telkens je daar een nieuwe tafel kiest, begint de teller weer van voren.</p>
            <button type="button" class="btn btn-lg btn-primary" id="startbtn">Start!</button>
            </div>
            <!-- /#intro -->
            <!-- # excercise -->
            <div id="excercise"><h1 class="cover-heading"><span id="firstpart"></span> x <span id="secondpart"></span> <span id="feedback"></span></h1>
            <table class="table table-bordered" id="honderdveld">
              <tr>
                <td>Bezig met laden...</td>
              </tr>
            </table>
            <button type="button" class="btn btn-lg btn-primary" id="nextbtn">Volgende</button>
          </div>
          <!-- /#excercise -->
          </div>

          <div class="mastfoot">
            <div class="inner">
              <div class="progress">
                <div class="progress-bar progress-bar-success" role="progressbar" style="width: 20%">
                  <span class="sr-only">Countdown timer</span>
                </div>
              </div>
            </div>
          </div>

        </div>

      </div>

    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script>
    $( document ).ready(function() {
        $("#loading").hide();
        $("#intro").show();
        // begin initial data
        var multitables = [2,3,4,5,6,7,8,9,10];
        var multipliers = [1,2,3,4,5,6,7,8,9,10];
        var excounter = 0;
        // end initial data
        function drawField() {
          var fieldhtml ="";
          for(var row = 0, rlen = 10; row< rlen; row++) {
            fieldhtml+="<tr>";
            for(var cell = 1, clen = 10; cell<= clen; cell++) {
              var cellval=(row*10)+cell;
              fieldhtml+="<td class='clickcell' id='cell"+cellval+"'><a class='celllink' data-value='"+cellval+"' href='?firstpart="+window.qtoshow[0].firstpart+"&secondpart="+window.qtoshow[0].secondpart+"&answer="+cellval+"'>"+cellval+"</a></td>";
            }  
            fieldhtml+="</tr>";
          }  
          $("#honderdveld").html(fieldhtml);
          $(".celllink").click(function(event){
            event.preventDefault();
            $(".celllink").removeClass("hilite");
            $(this).addClass("hilite");
            var answerclicked = parseInt($(this).attr("data-value"));
            checkAnswer(answerclicked);
            //console.log($(this).attr("data-value"));
          });
          //console.log(fieldhtml);
        }
        function goTables(limit) {
            if (multitables.indexOf(limit) > -1) {
              var mytables = [limit];
            } else {
              var mytables = multitables;
            }
            window.questions = [];
            //var qcounter = 0;
            for(var i = 0, len = mytables.length; i< len; i++) {
              var firstpart = mytables[i];
              for(var j = 0, jlen = multipliers.length; j< jlen; j++) {
                var secondpart = multipliers[j];
                var solution = firstpart*secondpart;
                var thisquestion = Object.create(null);
                thisquestion.firstpart = firstpart;
                thisquestion.secondpart = secondpart;
                thisquestion.solution = solution;
                window.questions.push(thisquestion);
              }
            }           
            console.table(window.questions);
            getQuestion();
        }
        function getQuestion(q) {
          if (q===undefined || q < 0) {           
            if (window.questions.length===1) {
              q=0;
            } else {
              q=Math.floor(Math.random()*(window.questions.length));
            }
          }
          //console.log("get question: "+q);
          window.qtoshow = window.questions.splice(q, 1);
          //console.log(qtoshow[0]);
          //console.log(qtoshow[0].firstpart);
          $("#firstpart").html(window.qtoshow[0].firstpart);
          $("#secondpart").html(window.qtoshow[0].secondpart);
          $("#feedback").html("<span class='glyphicon glyphicon-question-sign'></span>");
          drawField();
          $('#nextbtn').prop('disabled', true);
          //console.table(qtoshow);

        }
        function checkAnswer(answer){
          //console.log(answer+" / "+window.qtoshow[0].solution);
          if (answer===window.qtoshow[0].solution) {
            $("#feedback").html("<span class='glyphicon glyphicon-ok-circle'></span>");
            $('#nextbtn').prop('disabled', false);
          } else {
            $("#feedback").html("<span class='glyphicon glyphicon-remove-circle'></span>");  
            $('#nextbtn').prop('disabled', true);          
          }
        }
        //initial button activate
        $("#startbtn").click(function(){
          $("#intro").hide();
          $("#excercise").show();
          goTables();
        });
        // next button action
        $('#nextbtn').click(function(){
          getQuestion();
          console.log(window.questions.length);
        });
    });
    </script>
  </body>
</html>
